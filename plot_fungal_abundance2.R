mTS2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTS2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTS2r"))
tMK2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMK2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMK2r"))
mMK5r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMK5r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMK5r"))
tMS1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMS1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMS1r"))
mTK1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTK1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTK1r"))
tMK3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMK3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMK3r"))
mTS3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTS3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTS3r"))
tTS4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTS4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTS4r"))
mMK4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMK4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMK4r"))
tMS3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMS3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMS3r"))
mTK3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTK3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTK3r"))
tTK4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTK4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTK4r"))
mMS4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMS4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMS4r"))
mTK2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTK2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTK2r"))
tMS2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMS2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMS2r"))
tTK5r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTK5r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTK5r"))
tMK1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMK1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMK1r"))
mTS1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTS1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTS1r"))
tMS4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMS4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMS4r"))
mTK4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTK4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTK4r"))
tTK3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTK3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTK3r"))
mMS3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMS3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMS3r"))
tTS1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTS1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTS1r"))
mMK1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMK1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMK1r"))
mTK5r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTK5r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTK5r"))
mMS2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMS2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMS2r"))
tTK2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTK2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTK2r"))
tTK1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTK1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTK1r"))
mMS1r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMS1r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMS1r"))
tMK5r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMK5r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMK5r"))
mMK2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMK2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMK2r"))
tTS2r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTS2r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTS2r"))
tMK4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tMK4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tMK4r"))
mTS4r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mTS4r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mTS4r"))
tTS3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/tTS3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "tTS3r"))
mMK3r<-read_tsv("/Users/katieemelianova/Desktop/Dactylorhiza/abundances/mMK3r_abundances.txt") %>% dplyr::select(c("TAXPATHSN", "PERCENTAGE")) %>% set_colnames(c("TAXPATHSN", "mMK3r"))



my_dfs<-list(mTS2r, tMK2r, mMK5r, tMS1r, mTK1r, 
  tMK3r, mTS3r, tTS4r, mMK4r, tMS3r, 
  mTK3r, tTK4r, mMS4r, mTK2r, tMS2r, 
  tTK5r, tMK1r, mTS1r, tMS4r, mTK4r, 
  tTK3r, mMS3r, tTS1r, mMK1r, mTK5r, 
  mMS2r, tTK2r, tTK1r, mMS1r, tMK5r, 
  mMK2r, tTS2r, tMK4r, mTS4r, tTS3r, mMK3r)


samples_to_exclude<-c("mTS2r", "tTS4r", "tTK1r")
my_dfs %<>% 
  purrr::reduce(inner_join, by='TAXPATHSN') %>% 
  dplyr::select(-samples_to_exclude) 



species <- c("species", colnames(my_dfs)[-1] %>% substr(1,1))
envir <- c("environment", colnames(my_dfs)[-1] %>% substr(2,2))
sample_id <- c("sample_id", colnames(my_dfs)[-1])

lfse_table<-rbind(species, envir, sample_id, my_dfs) %>% column_to_rownames(var="TAXPATHSN")
write.table(lfse_table, file="lefse_table.txt", col.names = FALSE, quote = FALSE, sep = "\t")


